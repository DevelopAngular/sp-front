<!-- Show the form designated for students -->
<div class="form">
  <!-- Buttons responsible for choosing formState -->
  <div class="locs" *ngIf="formState!=='datetime' && formState!=='students'">
    <app-gradient-button
      class="location-button"
      [gradient]="fromGradient"
      [hoverColor]="fromSolid"
      [minWidth]="'175px'"
      [minHeight]="'80px'"
      [fontSize]="'16px'"
      [disabled]="!!entryState"
      (buttonClick)="setFormState('from')"
    >{{ from_title }}
    </app-gradient-button>

    <!-- <div class="type-arrows"> -->
    <!-- <img [class.hidden]="travelType != 'round_trip'" class="round-trip"
          [src]="'./assets/RT Arrow.png' | resolveAsset"> -->
    <img class="arrow" [src]="'./assets/Arrow (Green).png' | resolveAsset">
    <!-- </div> -->

    <app-gradient-button
      class="location-button"
      [gradient]="toGradient"
      [hoverColor]="toSolid"
      [minWidth]="'175px'"
      [minHeight]="'80px'"
      [fontSize]="'16px'"
      [disabled]="!toEnabled && !entryState"
      (buttonClick)="setFormState('to')"
    >{{ to_title }}
    </app-gradient-button>

  </div>

  <div class="divider" [style.background-image]="dividerGradient">
    <img class="divider-icon" [src]="dividerIcon | resolveAsset">
    <div class="divider-text">{{dividerText}}</div>
  </div>

  <!-- Used to select the start time of a pass for later -->
  <div *ngIf="formState == 'datetime'" class="datetime-area">
    <div class="datetime-left">
      <app-date-time-picker (onUpdate)="requestTime=$event"></app-date-time-picker>
    </div>
    <div class="datetime-right">
      <div *ngIf="forStaff" class="toggle-wrapper loading-theme">
        <div class="toggle-title">Declinable</div>
        <mat-slide-toggle [checked]="isDeclinable" (change)="isDeclinable = $event.checked"></mat-slide-toggle>
      </div>
      <div *ngIf="forStaff" class="toggle-divider"></div>
      <div *ngIf="forStaff" class="toggle-description">
        If a student is able to decline a pass sent to them. <br><br> You {{isDeclinable?'don\'t':''}} have to know the location of the student(s) if non-declinable.
      </div>
      <app-gradient-button
        [gradient]="'#03CF31,#00B476'"
        [hoverColor]="'#00B476'"
        [minWidth]="'90px'"
        [minHeight]="'30px'"
        [fontSize]="'14px'"
        (buttonClick)="setFormState((forStaff?'students':'to'))"
        [style.width]="'90px'"
        [style.margin]="'15px auto'"
      >
      Done</app-gradient-button>
    </div>
  </div>

  <div *ngIf="formState==='students'" class="student-select">
    <app-student-search [style.width]="'75%'" (onUpdate)="selectedStudents=$event"></app-student-search>
      <app-gradient-button
      *ngIf="selectedStudents && selectedStudents.length > 0"
      [gradient]="'#03CF31,#00B476'"
      [hoverColor]="'#00B476'"
      [minWidth]="'90px'"
      [minHeight]="'30px'"
      [fontSize]="'14px'"
      [disabled]="selectedStudents.length<1"
      (buttonClick)="setFormState(((forLater&&isDeclinable)?'to':'from'))"
      [style.width]="'90px'"
    >
    Done ({{ selectedStudents.length }})</app-gradient-button>
  </div>

  <!-- Used to select the from_location -->
  <div *ngIf="formState == 'from'">
    <app-location-table [forStaff]="forStaff" [forLater]="forLater" [showFavorites]="true" class="locations" [type]="'location'" [placeholder]="'Search rooms'" (onSelect)="locationChosen($event, 'from')"></app-location-table>
  </div>

  <!-- Used to select the to_location -->
  <div *ngIf="formState == 'to'">
    <div *ngIf="toState == 'pinnables'" class="pinnable-wrapper">
      <mat-grid-list class="grid center" cols="4" rowHeight="75px" gutterSize="10px" [style.width]="'550px'">
        <mat-grid-tile *ngFor="let pinnable of pinnables | async">
          <app-pinnable [valid]="(fromLocation?(!pinnable.location || pinnable.location.id !== fromLocation.id):true)" [forStaff]="forStaff" [forLater]="forLater" [pinnable]="pinnable" (onSelectEvent)="pinnableSelected($event)"></app-pinnable>
        </mat-grid-tile>
      </mat-grid-list>
    </div>
    <div *ngIf="toState == 'category'">
      <app-location-table class="center" (onSelect)="locationChosen($event, 'to')"
                          [invalidLocation]="(fromLocation?fromLocation.id:'')" [forStaff]="forStaff" [hasLocks]="true" [category]="toCategory" [type]="'location'" [placeholder]="'Search ' +toCategory.toLowerCase()" > </app-location-table>
    </div>
  </div>
  <div *ngIf="formState == 'restrictedTarget'">
      <app-location-table class="center" (onSelect)="updateTarget($event)" [type]="'teachers'" [placeholder]="'Search teachers'" [staticChoices]="toLocation.teachers"></app-location-table>
  </div>
  <div *ngIf="formState == 'restrictedMessage'" class="message center">
    <textarea class="message-box" #messageBox [placeholder]="'Attach a message' +(requestTarget?(' for ' +requestTarget.last_name):'')" [(ngModel)]="requestMessage">{{ requestMessage }}</textarea>
      <app-gradient-button
        [gradient]="'#00B476, #03CF31'"
        [hoverColor]="'#04CD33'"
        [minWidth]="'50px'"
        [minHeight]="'20px'"
        [fontSize]="'12px'"
        (buttonClick)="sendRequest(messageBox.value)"
        class="message-button">
      {{(requestMessage===''?'Skip':'Add Message')}}
      </app-gradient-button>
  </div>
</div>