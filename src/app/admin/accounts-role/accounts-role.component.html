<div class="host" appSafariScroll (scroll)="onScroll($event)">
  <div class="accounts-role-wrapper"  *ngIf="tabVisibility">
    <div class="card card__top-bar ds-flex-start-between ds-w-100"
         [ngClass]="{'card__dark': darkTheme.isEnabled$.value}">
      <div class="ds-flex-start-start ds-h-100">

        <div class="back-button" *ngIf="!(dataTableEditState | async) && role !== 'g_suite'">
          <app-back-button routerLink="/admin/accounts"></app-back-button>
        </div>
        <div class="ds-h-100 ds-mx-10" *ngIf="(dataTableEditState | async)"></div>
        <div class="ds-mt-20 ds-mx-5" [ngSwitch]="role">
          <div *ngSwitchCase="'_all'">
            <div class="ds-mr-20">

              <div class="card_header ds-mb-10">
                <span [style.color]="darkTheme.getColor({dark: '#FFFFFF', white: '#1E194F'})" [style.padding-left]="0">All Accounts</span>
              </div>
              <div  *ngIf="!(dataTableEditState | async)" class="card_title tooltip-container">
                <img [src]="'./assets/Info (Blue-Gray).svg' | resolveAsset"
                     [matTooltip]="'All accounts at one place.'"
                     matTooltipClass="tooltip"
                     alt="">
                <span [style.font-weight]="'bold'">{{(accounts$ | async).total }} account{{(accounts$ | async).total > 1 ? 's' : ''}}</span><br>
                <div class="arrow-down-container">
                  <div class="arrow-down"></div>
                </div>
              </div>
              <div  *ngIf="(dataTableEditState | async)" class="card_title">
                <span [style.font-weight]="'bold'">{{selectedUsers.length}} Selected</span>
              </div>
            </div>
          </div>
          <div *ngSwitchCase="'_profile_admin'">
            <div class="card_header ds-mb-10">
              <img [src]="darkTheme.getIcon({
                  iconName: 'Admin',
                  darkFill: 'White',
                  lightFill: 'Navy'
                }) | resolveAsset" alt="Settings.svg">
              <span [style.color]="darkTheme.getColor({dark: '#FFFFFF', white: '#1E194F'})">Administrators</span>
            </div>
            <div *ngIf="!(dataTableEditState | async)" class="card_title tooltip-container">

              <img [src]="'./assets/Info (Blue-Gray).svg' | resolveAsset"
                   [matTooltip]="'An administrator has a high-level look at the school, configures passes, and views/generates reports.'"
                   matTooltipClass="tooltip"
                   alt="">
              <span [style.font-weight]="'bold'">{{(accounts$ | async).admin_count}} user{{(accounts$ | async).admin_count> 1 ? 's' : ''}}</span><br>
              <div class="arrow-down-container">
                <div class="arrow-down"></div>
              </div>
            </div>
            <div  *ngIf="(dataTableEditState | async)" class="card_title">
              <span [style.font-weight]="'bold'">{{selectedUsers.length}} Selected</span>
            </div>
          </div>
          <div *ngSwitchCase="'_profile_teacher'">
            <div class="card_header ds-mb-10">
              <img [src]="darkTheme.getIcon({
                  iconName: 'Teacher',
                  darkFill: 'White',
                  lightFill: 'Navy'
                }) | resolveAsset" alt="Settings.svg">
              <span [style.color]="darkTheme.getColor({dark: '#FFFFFF', white: '#1E194F'})">Teachers</span>
            </div>
            <div *ngIf="!(dataTableEditState | async)" class="card_title tooltip-container">
              <img [src]="'./assets/Info (Blue-Gray).svg' | resolveAsset"
                   [matTooltip]="' A teacher has a room or multiple rooms where students can create passes to.'+
  '                    A teacher can create passes, view hall monitor activity, and manage passes in his/her room.'"
                   matTooltipClass="tooltip"
                   alt="">
              <span [style.font-weight]="'bold'">{{(accounts$ | async).teacher_count}} user{{(accounts$ | async).teacher_count> 1 ? 's' : ''}}</span><br>
              <div class="arrow-down-container">
                <div class="arrow-down"></div>
              </div>
            </div>
            <div  *ngIf="(dataTableEditState | async)" class="card_title">
              <span [style.font-weight]="'bold'">{{selectedUsers.length}} Selected</span>
            </div>
          </div>
          <div *ngSwitchCase="'_profile_student'">
            <div class="card_header ds-mb-10">
              <img [src]="darkTheme.getIcon({
                  iconName: 'Student',
                  darkFill: 'White',
                  lightFill: 'Navy'
                }) | resolveAsset" alt="Settings.svg">
              <span [style.color]="darkTheme.getColor({dark: '#FFFFFF', white: '#1E194F'})">Students</span>
            </div>
            <div  *ngIf="!(dataTableEditState | async)" class="card_title tooltip-container">
              <img [src]="'./assets/Info (Blue-Gray).svg' | resolveAsset"
                   [matTooltip]="'A student can create passes, schedule passes for the future,'+
  '                and send pass requests to teachers.'"
                   matTooltipClass="tooltip"
                   alt="">
              <span [style.font-weight]="'bold'">{{(accounts$ | async).student_count }} user{{(accounts$ | async).student_count > 1 ? 's' : ''}}</span><br>
              <div class="arrow-down-container">
                <div class="arrow-down"></div>
              </div>
            </div>
            <div  *ngIf="(dataTableEditState | async)" class="card_title">
              <span [style.font-weight]="'bold'">{{selectedUsers.length}} Selected</span>
            </div>
          </div>
          <div *ngSwitchCase="'_profile_assistant'">
            <div class="card_header ds-mb-10">
              <img [src]="darkTheme.getIcon({
                  iconName: 'Secretary',
                  darkFill: 'White',
                  lightFill: 'Navy'
                }) | resolveAsset" alt="Settings.svg">
              <span [style.color]="darkTheme.getColor({dark: '#FFFFFF', white: '#1E194F'})">Assistants</span>
            </div>
            <div *ngIf="!(dataTableEditState | async)" class="card_title tooltip-container">
              <img [src]="'./assets/Info (Blue-Gray).svg' | resolveAsset"
                   [matTooltip]="'A secretary or substitute teacher acts as a certain teacher when they sign-in.' +
                      'They can manage passes in his/her room and create passes as that teacher.'"
                   matTooltipClass="tooltip"
                   alt="">
              <span [style.font-weight]="'bold'">{{(accounts$ | async).assistant_count || 0}} users</span><br>
              <div class="arrow-down-container">
                <div class="arrow-down"></div>
              </div>
            </div>
            <div  *ngIf="(dataTableEditState | async)" class="card_title">
              <span [style.font-weight]="'bold'">{{selectedUsers.length}} Selected</span>
            </div>
          </div>
        </div>
      </div>
      <div class="tool-panel ds-mx-20 ds-my-10" *ngIf="(dataTableEditState | async)">

        <div class="ds-flex-center-start">
          <!--<div class="ds-p-10"  *ngIf="role === '_all'">-->
            <!--<app-gradient-button-->
              <!--[gradient]="'#FFFFFF,#FFFFFF'"-->
              <!--[hoverColor]="'#FFFFFF'"-->
              <!--[textColor]="'#1F194E'"-->
              <!--[size]="'small'"-->
              <!--[disabled]="!selectedUsers.length"-->
              <!--(buttonClick)="exportAccountData()">-->
              <!--<span>Export Account Data</span>-->
            <!--</app-gradient-button>-->
          <!--</div>-->

          <div class="ds-p-10"  *ngIf="role === '_profile_admin' || role === '_profile_teacher'">
            <app-gradient-button
              [size]="'small'"
              [disabled]="!selectedUsers.length"
              [cursor]="'pointer'"
              [minHeight]="'32px'"
              [width]="'215px'"
              [hoverColor]="'#FFFFFF'"
              [fontSize]="'14px'"
              [fontWeight]="700"
              [gradient]="'#FFFFFF, #FFFFFF'"
              [textColor]="'#1F195E'"
              (buttonClick)="showProfileCard(selectedUsers[0], true)">
              <span>Bulk Permissions</span>
            </app-gradient-button>
          </div>

          <div class="ds-p-10" *ngIf="role !== '_all'">
            <app-gradient-button
              *ngIf="!bulkSignInStatus"
              [size]="'small'"
              [disabled]="!selectedUsers.length"
              [cursor]="'pointer'"
              [minHeight]="'32px'"
              [width]="'215px'"
              [fontSize]="'14px'"
              [fontWeight]="700"
              (buttonClick)="promptConfirmation($event.target, 'enable_sign_in')">
              <span>Enable sign-in</span>
            </app-gradient-button>
            <app-gradient-button
              *ngIf="bulkSignInStatus"
              [size]="'small'"
              [disabled]="!selectedUsers.length"
              [cursor]="'pointer'"
              [minHeight]="'32px'"
              [width]="'215px'"
              [fontSize]="'14px'"
              [fontWeight]="700"
              [gradient]="'#001115, #033294'"
              [hoverColor]="'#022F68'"
              (buttonClick)="promptConfirmation($event.target, 'disable_sign_in')">
              <span>Disable sign-in</span>
            </app-gradient-button>
          </div>

          <div class="ds-p-10">
            <app-gradient-button
              [size]="'small'"
              [disabled]="!selectedUsers.length"
              [cursor]="'pointer'"
              [minHeight]="'32px'"
              [width]="'280px'"
              [fontSize]="'14px'"
              [fontWeight]="700"
              [gradient]="'#DA2370, #FB434A'"
              [hoverColor]="'#DA2370'"
              (buttonClick)="promptConfirmation($event.target, 'delete_from_profile')">
              <span>{{ role === '_all' ? 'Delete Account & Data' : 'Remove from Profile' }}</span>
            </app-gradient-button>
          </div>
          <div class="ds-mx-10">
            <app-gradient-button
              [size]="'medium'"
              [cursor]="'pointer'"
              [gradient]="'#FFFFFF,#FFFFFF'"
              [hoverColor]="'#FFFFFF'"
              [textColor]="'#1F194E'"
              (buttonClick)="dataTableEditState.next(!dataTableEditState.value)">
              <div class="ds-flex-center-center">
                <span *ngIf="dataTableEditState.value">Done</span>
              </div>
            </app-gradient-button>
          </div>
        </div>
      </div>
      <div class="ds-flex-center-between ds-mr-20 ds-my-10" style="flex: 1 1 auto" *ngIf="!(dataTableEditState | async) && role !== 'g_suite'">
        <div class="ds-flex-center-end ds-w-100">
          <div class="ds-mx-10">
            <app-round-input
              [minWidth]="'230px'"
              [width]="'230px'"
              [type]="'text'"
              [placeholder]="'Search'"
              [pending$]="pending$"
              (ontextupdate)="findRelevantAccounts($event)">
            </app-round-input>
          </div>

            <!--<div class="ds-mx-10" *ngIf="role === '_all'">-->
              <!--<div class="card_title">-->
                <!--<span>G Suite: 2,237  Accounts</span>-->
              <!--</div>-->
              <!--<div class="card_title">-->
                <!--<span>Alternative: 23 Accounts</span>-->
              <!--</div>-->
            <!--</div>-->
            <div class="ds-mx-10" *ngIf="role !== '_all'">

              <app-gradient-button
                [size]="'medium'"
                [cursor]="'pointer'"
                [leftIcon]="'./assets/Plus (White).svg'"
                (buttonClick)="addUser()">
                <div class="ds-flex-center-center">
                  <span>Add</span>
                </div>
              </app-gradient-button>
            </div>
            <div class="ds-mx-10">

              <app-gradient-button
                [size]="'medium'"
                [cursor]="'pointer'"
                [gradient]="'#FFFFFF,#FFFFFF'"
                [hoverColor]="'#FFFFFF'"
                [textColor]="'#1F194E'"
                (buttonClick)="dataTableEditState.next(!dataTableEditState.value)">
                <div class="ds-flex-center-center">
                  <span *ngIf="!dataTableEditState.value">Edit</span>
                </div>
              </app-gradient-button>
            </div>
        </div>
      </div>
    </div>
    <div class="table" *ngIf="role !== 'g_suite'">
      <div *ngIf="!userList.length && !noUsersDummyVisibility" class="loading-theme_blue-gray spinner ds-flex-center-center">
        <mat-spinner *ngIf="!placeholder" [diameter]="50" [color]="'primary'"></mat-spinner>
        <!--<h1 [style.color]="darkTheme.getColor({dark: '#FFFFFF', white: '#7F879D'})" *ngIf="placeholder">No matches found.</h1>-->
        <div *ngIf="placeholder" class="ds-flex-center-center ds-flex-column ds-pt-25 ds-mt-25" [style.color]="darkTheme.getColor({dark: '#FFFFFF', white: '#7F879D'})">
          <img [src]="'./assets/emptyStates/no-matches-found.svg'" class="ds-py-25 ds-mt-25 ds-mb-10" alt="no-users.svg">
          <div class="ds-tab-text">No users found</div>
          <p class="ds-my-10" style="text-align: center; font-size: 15px;">Spellcheck? Wrong profile?</p>
        </div>
      </div>




      <div *ngIf="noUsersDummyVisibility" class="ds-flex-center-center ds-flex-column ds-pt-25 ds-mt-25" [style.color]="darkTheme.getColor({dark: '#FFFFFF', white: '#7F879D'})">
        <img [src]="'./assets/emptyStates/no-users.svg'" class="ds-py-25 ds-mt-25 ds-mb-10" alt="no-users.svg">
        <div class="ds-tab-text">No Users</div>
        <p class="ds-my-10" style="text-align: center; font-size: 15px;">Add users one-by-one above or set up G Suite <br>
          syncing to automatically add users to this profile.</p>
      </div>
      <div *ngIf="userList.length" class="ds-mt-15">
        <div class="column-settings">
          <app-icon-button class="options-icon" [srcString]="'Options'" [size]="16" (clickEvent)="showColumnSettings($event)"></app-icon-button>
          <!--<img draggable="false" width="20" [src]="darkTheme.getIcon({iconName: 'Options', lightFill: 'Blue-Gray'}) | resolveAsset" alt="Options (Navy).svg" (click)="showColumnSettings($event)">-->
        </div>
        <app-data-table
          class="ds-my-10"
          [data]="userList"
          [isCheckbox]="dataTableEditState"
          [textColor]="'#7E879D'"
          [disallowHover]="role === '_all' && !(dataTableEditState | async)"
          [displayedColumns]="dataTableHeadersToDisplay"
          (selectedCell)="findProfileByRole($event)"
          (selectedRow)="showProfileCard($event)"
          (selectedUsers)="setSelected($event)"
          >
        </app-data-table>
      </div>
    </div>
  </div>

  <div class="gsuite-wrapper" *ngIf="role === 'g_suite'">
    <div class="gsuite-header">
      <div class="header-content">
        <div class="left-block">
          <div class="back-button" routerLink="/admin/accounts">
            <img width="16" height="16" [src]="'./assets/Chevron Left (Blue-Gray).svg' | resolveAsset" alt="">
          </div>
          <div class="title-content">
            <img width="50" height="50" [src]="'./assets/google/google_logo.svg' | resolveAsset" alt="">
            <div class="title">
              G Suite
              <div class="small-text">{{ sync.last }}</div>
            </div>
          </div>
        </div>

        <div class="right-block">
          <div class="count-accounts">{{ countAccounts + ' accounts' }}</div>
          <div class="text">syncing from G Suite</div>
        </div>
      </div>
    </div>

    <div class="gsuite-content">
      <div class="content-wrapper">

        <div class="left-side">
          <div class="sync">
            <div class="title">Sync</div>
            <div class="subtitle">
              <div>{{ sync.last }}</div>
              <div>Next scheduled sync: {{ sync.next }}</div>
            </div>

            <div class="info">
              Syncs happen automatically every four hours, but you can also sync manually now.
            </div>
            <app-gradient-button
                    [size]="'small'"
                    [gradient]="'#022F68,#2F66AB'"
                    [hoverColor]="'#022F68'"
                    [fontSize]="'13px'"
                    [cursor]="'pointer'"
            >
              <div *ngIf="false" class="loading-theme_white spinner flex-center-left pt">
                <mat-spinner [color]="'white'" [diameter]="'25'"></mat-spinner>
              </div>
              <span *ngIf="true" >
                Sync Now
              </span>
            </app-gradient-button>
          </div>

          <div class="about-sync">
            <div class="about-title">About G Suite Sync</div>
            <div class="about-content">
              When a new account is created in G Suite,
              if they are added to a syncing organizational unit they will automatically be added to the specified SmartPass Group.
              <br/><br/>
              Sync automatically updates existing user details.
            </div>
          </div>

          <app-privacy-card></app-privacy-card>

        </div>

        <div class="right-side">
          <app-account-groups></app-account-groups>
        </div>
      </div>

      <div class="footer"></div>
    </div>
  </div>
</div>
