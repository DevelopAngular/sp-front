<div class="wrapper">
  <cdk-virtual-scroll-viewport class="example-viewport" itemSize="33">
    <table class="table"
           mat-table
           [dataSource]="dataSource"
           [multiTemplateDataRows]="true"
           matSort
    >

    <ng-container matColumnDef="select" *ngIf="isCheckbox | async">
      <th mat-header-cell *matHeaderCellDef>
        <mat-checkbox (change)="$event ? masterToggle() : null"
                      [checked]="selection.hasValue() && isAllSelected()"
                      [indeterminate]="selection.hasValue() && !isAllSelected()"
                      [aria-label]="checkboxLabel()">
        </mat-checkbox>
      </th>
      <td mat-cell *matCellDef="let row">
        <mat-checkbox (click)="$event.stopPropagation()"
                      (change)="$event ? selection.toggle(row) : null"
                      [checked]="selection.isSelected(row)"
                      [aria-label]="checkboxLabel(row)">
        </mat-checkbox>
      </td>
    </ng-container>

      <ng-container [matColumnDef]="column" *ngFor="let column of displayedColumns; last as isLast; first as isFirst">
        <th [style.border-right]="!isLast ? '1px solid #7E879D' : 'none'" mat-sort-header mat-header-cell *matHeaderCellDef>
          {{ column }}
          <div class="sort-icon" *ngIf="!isFirst">
            <mat-icon class="icon" [ngStyle]="{'color': '#7F879D'}">arrow_drop_up</mat-icon>
            <mat-icon class="icon" [ngStyle]="{'color': '#7F879D'}">arrow_drop_down</mat-icon>
          </div>
        </th>
        <td mat-cell [style.border-right]="isFirst ? '1px solid #7E879D' : 'none'" *matCellDef="let element" [innerHTML]="element[column]"></td>
      </ng-container>

      <tr class="header" mat-header-row *matHeaderRowDef="columnsToDisplay; sticky: true"></tr>

      <!-- cdkVirtualScrollViewport uses transform: translateY to correct for all elements that are removed.
      We will use a plcaholder row in the table instead because the translate causes problems with the sticky header -->
      <tr [style.height.px]="placeholderHeight" mat-row *matRowDef="let row; let index = index; columns: []; when: placeholderWhen"></tr>

      <tr mat-row *matRowDef="let row; columns: columnsToDisplay"></tr>
    </table>
  </cdk-virtual-scroll-viewport>
</div>

