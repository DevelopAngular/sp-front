<div class="wrapper">
  <div class="spinner-container" *ngIf="loading$ | async">
    <div class="loading-theme_blue-gray spinner ds-flex-center-center">
      <mat-spinner [diameter]="50" [color]="'primary'"></mat-spinner>
    </div>
  </div>
  <div class="empty-state" *ngIf="showEmptyState">
    <div class="empty-content">
      <img width="135" style="opacity: 0.2" [src]="emptyIcon | resolveAsset" alt="Empty">
      <div class="empty-description">
        <span *ngIf="emptyText">{{ emptyText }}</span>
      </div>
    </div>
  </div>
    <cdk-virtual-scroll-viewport class="example-viewport" [itemSize]="itemSize" [style.height]="height">
      <table class="table" mat-table [dataSource]="dataSource" [multiTemplateDataRows]="true" matSort>
        <ng-container matColumnDef="select" *ngIf="isCheckbox | async" sticky>
          <th mat-header-cell *matHeaderCellDef style="padding: 0 15px;">
            <mat-checkbox (change)="$event ? masterToggle() : null"
                          [checked]="selection.hasValue() && isAllSelected()"
                          [style.color]="selection.hasValue() ? '#1F195E' : '#7F879D'"
                          [indeterminate]="selection.hasValue() && !isAllSelected()"
                          [aria-label]="checkboxLabel()">
            </mat-checkbox>
          </th>
          <td mat-cell *matCellDef="let row" style="padding: 0 15px;">
            <mat-checkbox (click)="$event.stopPropagation()"
                          (change)="$event ? select(row) : null"
                          [checked]="selection.isSelected(row)"
                          [style.color]="selection.isSelected(row) ? '#1F195E' : '#7F879D'"
                          [aria-label]="checkboxLabel(row)">
            </mat-checkbox>
          </td>
        </ng-container>

        <ng-container [matColumnDef]="column" *ngFor="let column of displayedColumns; last as isLast; first as isFirst" [sticky]="isFirst">
          <ng-container *ngIf="column !== 'Pass' && column !== 'Passes'; else passNoSort">
            <th
              [style.border-right]="!isLast ? '1px solid #7E879D' : 'none'"
              [style.background-color]="getColumnSort(column) === 'asc' || getColumnSort(column) === 'desc' ? '#e5e6eb' : '#D3D6DE'"
              mat-sort-header
              mat-header-cell
              *matHeaderCellDef
            >
              {{ column }}
              <div class="sort-icon">
                <mat-icon class="icon" [ngStyle]="{'color': getColumnSort(column) === 'asc' ? '#666D81' : '#7F879D'}">arrow_drop_up</mat-icon>
                <mat-icon class="icon" [ngStyle]="{'color': getColumnSort(column) === 'desc' ? '#666D81' : '#7F879D'}">arrow_drop_down</mat-icon>
              </div>
            </th>
          </ng-container>

          <ng-template #passNoSort>
            <th
              style="padding-left: 10px; padding-right: 15px"
              [style.border-right]="!isLast ? '1px solid #7E879D' : 'none'"
              mat-header-cell
              *matHeaderCellDef>
              {{ column }}
            </th>
          </ng-template>

          <td
            mat-cell
            [style.padding]="column === 'Pass' ? '0 15px 0 10px' : ''"
            [style.border-right]="isFirst ? '1px solid #7E879D' : 'none'"
            *matCellDef="let element"
            [innerHTML]="element[column]"
          ></td>
        </ng-container>

        <tr class="header" mat-header-row *matHeaderRowDef="columnsToDisplay; sticky: true"></tr>

        <!-- cdkVirtualScrollViewport uses transform: translateY to correct for all elements that are removed.
        We will use a plcaholder row in the table instead because the translate causes problems with the sticky header -->
        <tr [style.height.px]="placeholderHeight" mat-row *matRowDef="let row; let index = index; columns: []; when: placeholderWhen"></tr>

        <tr mat-row *matRowDef="let row; columns: columnsToDisplay;"
            [style.background-color]="selection.isSelected(row) ? '#ECF1FF' : '#FFFFFF'"
            [style.cursor]="isRowClick ? 'pointer' : 'default'"
            appCrossPointerEventTarget (pointerClickEvent)="isRowClick ? rowOnClick(row) : null">
        </tr>
      </table>
    </cdk-virtual-scroll-viewport>

  <div class="table-options-screen" [ngClass]="{'shadow': hasHorizontalScroll}">
    <div class="buttons">
      <div class="button" appCrossPointerEventTarget (pointerClickEvent)="openOption(option.action, $event)" *ngFor="let option of tableOptionButtons; first as isFirst" [style.margin-top]="isFirst ? 0 : '25px'">
        <img width="20" [src]="'./assets/' + option.icon + ' ('+ (selection.selected.length && !isFirst ? 'Navy' : 'Blue-Gray') +').svg' | resolveAsset">
      </div>
    </div>
  </div>

</div>

